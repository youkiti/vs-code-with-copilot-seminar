# 4. AIツールの使い方

このセクションでは、GitHub Copilotを使って効率的にコードを書く方法を学びます。

## 目標

- GitHub Copilotの基本的な使い方の理解
- AIによるコード補完の活用方法の習得
- コードの品質管理とデバッグ手法の習得

## 4.1 GitHub Copilotの基本

### コード補完の基本

1. コメントを書いて意図を伝える
```R
# 年齢が20歳以上のデータを抽出する
```

2. Copilotが提案するコードを確認
```R
data %>%
    filter(age >= 20)
```

3. Tab キーで提案を受け入れる

### 効果的なプロンプトの書き方

良い例：
```R
# 年齢（age）と身長（height）の散布図を作成し、
# 性別（sex）で色分けする
```

悪い例：
```R
# グラフを作る
```

## 4.2 エラー対処とトラブルシューティング

### Copilotを活用したエラー解決

1. エラーメッセージをコメントとして記述
```R
# Error: object 'data' not found が発生
# データの読み込みと前処理方法を提案してください
```

2. エラーの原因と解決策をCopilotが提案
```R
# データの読み込みが必要です
data <- read.csv("your_data.csv")

# データの存在確認
if(exists("data")) {
    print("データが正常に読み込まれました")
} else {
    print("データの読み込みに失敗しました")
}
```

### エラーメッセージの活用

1. エラーメッセージをそのままコメントとして記述
```R
# Error in filter(data, age >= 20) : 
#   could not find function "filter"
```

2. Copilotが必要なパッケージの読み込みを提案
```R
# dplyrパッケージの読み込みが必要です
library(dplyr)

# その後でfilter関数を使用
data %>%
    filter(age >= 20)
```

## 4.3 コードの流れを設計する

### コメントによる設計の提案

1. 大まかな流れをコメントで記述
```R
# 1. データの読み込み
# 2. 欠損値の確認と処理
# 3. 基本統計量の算出
# 4. グラフの作成
```

2. Copilotが各ステップのコードを提案
```R
# 1. データの読み込み
data <- read.csv("data.csv")

# 2. 欠損値の確認と処理
summary(data)
data_clean <- na.omit(data)

# 3. 基本統計量の算出
data_summary <- data_clean %>%
    group_by(group) %>%
    summarise(
        mean = mean(value),
        sd = sd(value)
    )

# 4. グラフの作成
ggplot(data_clean, aes(x = group, y = value)) +
    geom_boxplot()
```

### 段階的な実装

1. 処理の概要をコメントで記述
```R
# 高血圧研究の解析手順：
# 1. 患者データの読み込み
# 2. 血圧値の異常値チェック
# 3. 年齢層による層別解析
# 4. 結果の可視化
```

2. 各ステップの詳細をコメントで追加
```R
# 1. 患者データの読み込み
# - CSVファイルから読み込み
# - 列名の確認
# - データ型の確認

# 2. 血圧値の異常値チェック
# - 基準値の設定（収縮期血圧: 60-250 mmHg）
# - 異常値の除外
# - 除外前後のデータ数の確認

# 3. 年齢層による層別解析
# - 年齢層の定義（若年、中年、高年）
# - 層別の記述統計
# - 層別の血圧分布

# 4. 結果の可視化
# - 年齢層別の箱ひげ図
# - 血圧分布のヒストグラム
# - 層別の要約統計表
```

## 4.4 実践的な使用方法

### データ前処理での活用

```R
# 以下のデータクリーニングを行う：
# 1. 欠損値の除去
# 2. 年齢が0-100の範囲内のデータのみ抽出
# 3. BMIを計算（体重(kg) / 身長(m)^2）
```

### 統計解析での活用

```R
# 以下の統計解析を実行：
# 1. 年齢と身長の相関係数を計算
# 2. 性別ごとの年齢の平均値と標準偏差を算出
# 3. 2群間のt検定を実施
```

### データ可視化での活用

```R
# 以下のグラフを作成：
# 1. 年齢のヒストグラム
# 2. 性別ごとの箱ひげ図
# 3. 散布図にトレンドラインを追加
```

## 4.3 コードの品質管理

### コードレビューのポイント

1. 可読性
   - 適切な変数名が使用されているか
   - コメントは分かりやすいか
   - コードの構造は論理的か

2. 効率性
   - 不必要な処理はないか
   - メモリ使用は適切か
   - 処理速度は許容範囲か

3. 信頼性
   - エラー処理は適切か
   - 異常値への対応は考慮されているか
   - テストは十分か

### デバッグ手法

1. エラーメッセージの解読
   - エラーの種類を特定
   - エラーが発生した場所を確認
   - エラーの原因を推測

2. デバッグ用の出力
```R
# デバッグ情報の出力
print(str(data))  # データ構造の確認
print(head(data)) # 先頭数行の確認
```

3. 段階的なデバッグ
   - 問題のある部分を特定
   - 小さな単位でテスト
   - 修正後の動作確認

## 4.4 効率的な開発フロー

### コーディングの基本ステップ

1. 要件の整理
   - 目的の明確化
   - 必要なデータの特定
   - 期待される結果の定義

2. コードの実装
   - コメントで処理内容を記述
   - Copilotの提案を活用
   - 段階的に実装

3. テストと改善
   - 動作確認
   - コードの最適化
   - ドキュメント化

## チェックポイント

以下の項目を確認してください：

- [ ] GitHub Copilotの基本的な使い方を理解している
- [ ] 効果的なプロンプトが書ける
- [ ] コードの品質管理ができる
- [ ] デバッグ手法を理解している
- [ ] 効率的な開発フローを実践できる

## 演習問題

1. サンプルデータを使って、Copilotの支援を受けながらデータ分析を行ってみましょう
2. 自分で書いたコードをレビューし、改善点を見つけてみましょう
3. エラーが発生した場合のデバッグを実践してみましょう

## 次のステップ

AIツールの使い方を理解したら、[次のセクション](../05-project/README.md)に進んでください。
